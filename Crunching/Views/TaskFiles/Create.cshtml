@{
    ViewBag.Title = "Create";
    Layout = null;
}

@Html.Partial("Init")

<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>

			<div class="main-content">
				<div class="breadcrumbs" id="breadcrumbs">
					<script type="text/javascript">
					    try { ace.settings.check('breadcrumbs', 'fixed') } catch (e) { }
					</script>
					<ul class="breadcrumb">
						<li>
							<i class="icon-home home-icon"></i>
							<a href="@Url.Action("Index","Home")">Home</a>
							<span class="divider"><i class="icon-angle-right arrow-icon"></i></span>
						</li>
						<li class="active">Create File</li>
					</ul><!--.breadcrumb-->
				</div>
				<div class="page-content">
                    @using (Html.BeginForm("Create", "TaskFiles", FormMethod.Post, new { @class = "margin-bottom-40 form-horizontal", @role = "form", enctype = "multipart/form-data", @id = "Create" }))
                    {
                        @Html.ValidationSummary(true)
                        <div class="alert alert-success" role="alert">Only one file with a max of 2Mb is allowed for uploading</div>
					<div class="row-fluid">
						<div class="span10">
							<!--PAGE CONTENT BEGINS-->
                            <h3 class="header smaller lighter blue">Add a new file to the task</h3>
                           <div id="dropzone">
								<div class="dropzone">
									<div class="fallback">
										<input name="file" type="file" multiple="" />
									</div>
								</div>
							</div><!--PAGE CONTENT ENDS-->

                            <input type="hidden" id="idTicket" value="@ViewBag.idTask" name="idTask" />
                            <div class="form-actions">
           					    <button class="btn btn-info" type="button" onclick="javascript:document.forms[0].submit()">
									<i class="icon-ok bigger-110"></i>
									Save
								</button>
								&nbsp; &nbsp; &nbsp;
								<button class="btn" type="reset" onclick="javascript:location.href='@Url.Action("Details", "Subtasks", new { id = ViewBag.idTask })'">
									<i class="icon-undo bigger-110"></i>
									Cancel
								</button>
							</div>
							<!--PAGE CONTENT ENDS-->
						</div><!--/.span-->
					</div><!--/.row-fluid-->
                    }
				</div><!--/.page-content-->

			</div><!--/.main-content-->

@Html.Partial("end")
      
<link rel="stylesheet" href="@Url.Content("~/assets/css/dropzone.css")" />
<script src="@Url.Content("~/assets/js/dropzone.min.js")"></script>

                        <script type="text/javascript">
                            jQuery(function ($) {

                                try {
                                    $(".dropzone").dropzone({
                                        paramName: "file", // The name that will be used to transfer the file
                                        maxFilesize: 0.5, // MB

                                        addRemoveLinks: true,
                                        dictDefaultMessage:
				'<span class="bigger-150 bolder"><i class="icon-caret-right red"></i> Drop files</span> to upload \
				<span class="smaller-80 grey">(or click)</span> <br /> \
				<i class="upload-icon icon-cloud-upload blue icon-3x"></i>'
			,
                                        dictResponseError: 'Error while uploading file!',

                                        //change the previewTemplate to use Bootstrap progress bars
                                        previewTemplate: "<div class=\"dz-preview dz-file-preview\">\n  <div class=\"dz-details\">\n    <div class=\"dz-filename\"><span data-dz-name></span></div>\n    <div class=\"dz-size\" data-dz-size></div>\n    <img data-dz-thumbnail />\n  </div>\n  <div class=\"progress progress-small progress-success progress-striped active\"><span class=\"bar\" data-dz-uploadprogress></span></div>\n  <div class=\"dz-success-mark\"><span></span></div>\n  <div class=\"dz-error-mark\"><span></span></div>\n  <div class=\"dz-error-message\"><span data-dz-errormessage></span></div>\n</div>"
                                    });
                                } catch (e) {
                                    alert('Dropzone.js does not support older browsers!');
                                }

                            });
		</script>

              